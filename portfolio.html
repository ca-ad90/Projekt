<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carl Adrian - Portfolio</title>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/Grids.css">
    <link rel="stylesheet" href="css/typografi.css">
    <link rel="stylesheet" href="css/Style.css">
    <link rel="stylesheet" href="css/portfolio.css">
    <link rel="stylesheet" href="header.css">
</head>

<body>
    <div class="navbar-wrapper">
        <div class="navbar-btn">

           <svg class="svg-ico" viewBox="0 0 100 100">
              <path class="ico" fill="none" stroke-width="10" stroke="white" />

           </svg>

        </div>
        <div class="navbar-blocker"></div>
        <nav class="navbar-content">
           <div class="navbar-item">nav item 1</div>
           <div class="navbar-item">nav item 2</div>
           <div class="navbar-item">nav item 3</div>
           <div class="navbar-item">nav item 4</div>
        </nav>
        <svg class="navbar-svg">
           <path class="test" stroke="none" fill="orange" d="
            M 5 5
            l 0 10
            l 10 0
            q 0 0 0 -10 z
           " />
        </svg>

        <script src="header.js"></script>

     </div>
    <div id="grid-wrapper" class="full-page">
        <header>
            <header id="part-1" class="gridder">
                <nav>
                        <div class="nav-wrapper">
                           <a class="nav-link" href="about.html">
                              <div class="nav-btn">
                                 About
                              </div>
                           </a>
                           <a class="nav-link" href="portfolio.html">
                              <div class="nav-btn">
                                 Portfolio
                              </div>
                           </a>
                           <a class="nav-link" href="gallery.html">
                              <div class="nav-btn">
                                 Gallery
                              </div>
                           </a>
                           <a class="nav-link" href="contact.html">
                              <div class="nav-btn">
                                 Contact
                              </div>
                           </a>
                        </div>
                     </nav>                
            </header>
        </header>
        <section class="portfolio-scroll full-page">
            <div class="section-wrapper section-left">
                <div class="img container">
                    <div class="img scroll-container top" name="img">
                        <div id="img-1" name="Bild-1" class="img part top main"></div>
                        <div id="img-2" name="Bild-2" class="img part top main"></div>
                        <div id="img-3" name="Bild-3" class="img part top main"></div>
                        <div id="img-4" name="Bild-4" class="img part top main"></div>
                        <div id="img-5" name="Bild-5" class="img part top main"></div>
                        <div id="img-6" name="Bild-6" class="img part top main"></div>
                        <div id="img-7" name="Bild-7" class="img part top main"></div>
                    </div>

                </div>
                <div class="info container">
                    <div class="info head scroll-container left" name="head">
                        <h2 pos="1" id="head-1" class="info part top rub">Portfolio-item 1</h2>
                        <h2 pos="2" id="head-2" class="info part top rub">Portfolio-item 2</h2>
                        <h2 pos="3" id="head-3" class="info part top rub">Portfolio-item 3</h2>
                        <h2 pos="4" id="head-4" class="info part top rub">Portfolio-item 4</h2>
                        <h2 pos="5" id="head-5" class="info part top rub">Portfolio-item 5</h2>
                        <h2 pos="6" id="head-6" class="info part top rub">Portfolio-item 6</h2>
                        <h2 pos="7" id="head-7" class="info part top rub">Portfolio-item 7</h2>
                    </div>
                    <div class="info text scroll-container bottom" name="text">
                        <p pos="1" id="text-1" class="info part top para">
                            Minim velit ad ipsum pariatur consectetur mollit esse culpa minim minim laboris ea velit
                            magna proident eiusmod esse do officia. Veniam proident laboris ullamco reprehenderit eu
                            cillum ipsum excepteur proident cupidatat id reprehenderit.

                        </p>

                        <p pos="2" id="text-2" class="info part top para">
                            Veniam proident laboris ullamco reprehenderit eu cillum ipsum excepteur proident
                            cupidatat
                            id reprehenderit. Aliqua proident officia aute esse sit sunt aliqua ullamco pariatur ad
                            dolor mollit ullamco cupidatat.
                        </p>

                        <p pos="3" id="text-3" class="info part top para">
                            Lorem ipsum dolor sit amet, sunt enim incididunt mollit nostrud ea mollit veniam. Labore
                            adipisicing ea amet non aliqua sit sint ad. Consequat consequat veniam consectetur
                            fugiat
                            anim proident consectetur pariatur in.

                        </p>

                        <p pos="4" id="text-4" class="info part top para">
                            Mollit ipsum sit irure culpa duis non mollit nisi adipisicing consequat id. Mollit culpa
                            sint deserunt aliquip deserunt tempor aute ex commodo tempor aliquip.

                        </p>
                        <p pos="5" id="text-5" class="info part top para">
                            Lorem ipsum dolor sit amet, eiusmod in elit eu ex qui est nostrud amet sint labore ullamco.
                            Labore non excepteur do irure laboris. Dolor veniam laborum aute vel it dolore consectetur
                            reprehenderit mollit.
                        </p>
                        <p pos="6" id="text-6" class="info part top para">
                            Nisi fugiat officia mollit non dolore non eu Ipsum qui ut duis velit nisi. Officia
                            exercitation exercitation sit mollit deserunt aliquip sunt consequat est quis. Quis nisi
                            fugiat sint dolor elit sit nostrud mollit excepteur laboris.

                        </p>
                        <p pos="7" id="text-7" class="info part top para">
                            Aute do consectetur aliquip enim fugiat quis aliquip ea. Sint magna amet nulla eu nostrud
                            fugiat culpa reprehenderit labore. Laboris irure nisi magna culpa qui laboris pariatur
                            tempor laboris.


                        </p>
                    </div>
                    <div class="info extra scroll-container left" name="extra">

                        <p pos="1" id="extra-1" class="info part top extra">Här vet jag inte riktigt vad det skall stå..
                        </p>

                        <p pos="2" id="extra-2" class="info part top extra">Här vet jag inte riktigt vad det skall stå..
                        </p>

                        <p pos="3" id="extra-3" class="info part top extra">Här vet jag inte riktigt vad det skall stå..
                        </p>
                        <p pos="4" id="extra-4" class="info part top extra">Här vet jag inte riktigt vad det skall stå..
                        </p>
                        <p pos="5" id="extra-5" class="info part top extra">Här vet jag inte riktigt vad det skall stå..
                        </p>
                        <p pos="6" id="extra-6" class="info part top extra">Här vet jag inte riktigt vad det skall stå..
                        </p>
                        <p pos="7" id="extra-7" class="info part top extra">Här vet jag inte riktigt vad det skall stå..
                        </p>
                    </div>
                </div>
            </div>

        </section>
        <section class="portfolio-info">

        </section>
    </div>
    <script>
        var current = 1
        var start = 0

        class scrollHandler {
            constructor(containerSelector) {
                $(window).on("wheel keydown pointerdown pointermove pointerup", this.handler.bind(this))
                this.pDown = false;
                this.pMove = false
                this.pUp = true;
                this.selector = containerSelector
                this.current = 1
                this.timeStamp = new Date().getTime()
                this.start = new Date().getTime()
                this.e
                this.type
                this.next
                this.pointer = {
                    x: 0,
                    y: 0
                }

            }
            get containers() {
                return document.querySelectorAll(".scroll-container")
            }

            handler(e) {
                this.timeStamp = new Date().getTime()
                this.type = e.type
                this.next = null
                if (this.timeStamp - this.start > 100 || this.type.replace("pointer", "") != this.type) {
                    switch (this.type) {
                        case "keydown":
                            this.onKeyDown(e.originalEvent)
                            break;
                        case "wheel":
                            this.onWheel(e.originalEvent)
                            break;
                        case "pointerdown":
                        case "pointermove":
                        case "pointerup":
                            this.onPointer(e.originalEvent)
                            break;

                        default:
                            break;
                    }

                }

                this.start = new Date().getTime()
            }
            onKeyDown(e) {
                if (e.keyCode == 40 || e.keyCode == 38)
                    this.next = e.keyCode == 40 ? this.current + 1 : this.current - 1
                this.scrollTo(this.next)
            }

            onWheel(e) {
                console.log(e)
                this.next = e.wheelDelta < 0 ? this.current + 1 : this.current - 1
                this.scrollTo(this.next)
            }

            onPointer(e) {
                if (this.type == "pointerdown") {
                    this.pMove = true;
                    this.pointer = {
                        x: e.clientX,
                        y: e.clientY,
                    }
                }
                if (this.type == "pointermove" && this.pMove) {
                    var lenX = e.clientX - this.pointer.x
                    var lenY = e.clientY - this.pointer.y
                    console.log("X:", lenX)
                    console.log("Y:", lenY)
                    try {
                        if (((lenX > 150 || lenX < -150) && lenY < 50 && lenY > -50) || ((lenY > 150 || lenY < -
                                    150) &&
                                lenX < 50 && lenX > -50)) {
                            console.log("ScrollTime")
                            this.pMove = false
                            var len = Math.abs(lenX) > Math.abs(lenY) ? lenX : lenY
                            this.next = len < 0 ? this.current + 1 : this.current - 1
                            this.scrollTo(this.next)

                        }
                    } catch {
                        debugger
                        if (((lenX > 150 || lenX < -150) && lenY < 50 && lenY > -50) || ((lenY > 150 || lenY < -
                                    150) &&
                                lenX < 50 && lenX > -50)) {
                            console.log("ScrollTime")



                            var len = Math.abs(lenX) > Math.abs(lenY) ? lenX : lenY
                            this.next = len > 0 ? this.current + 1 : this.current - 1
                            this.scrollTo(this.next)
                            this.pMove = false
                        }
                    }

                }

                if (this.type == "pointerup") {
                    this.pMove = false
                }
            }

            async scrollTo(p) {
                console.log(this.next, p)
                if (p < 1 || p > this.containers[0].children.length || p == null) {
                    this.next = 0;
                    return
                }


                this.containers.forEach(async(e, i) => {
                    var dirList = ["top", "left", "right", "bottom"]
                    var dir
                    let name = e.getAttribute("name")
                    var from = 100;
                    var to = -100;
                    for (let d of dirList) {
                        if (e.classList.contains(d)) {
                            dir = d
                            break;
                        }
                    }var bgPos = Number($(".img.container").css("background-position-y").replace("px",""))

                    if (p < this.current) {
                        bgPos+=60
                        from = -1 * from;
                        to = -1 * to;
                    }else{
                        bgPos-=60
                    }
                    $(".img.container").css("background-position-y",bgPos+"px")


                    var currentElement = e.querySelector("#" + name + "-" + this.current)
                    var nextElement = e.querySelector("#" + name + "-" + p)

                    var reset = new Promise(resolve => {
                        setTimeout((resolve) => {
                            e.querySelectorAll(".part").forEach(el => {
                                el.classList.add("return")
                            })

                            $(e).find(".part").not(currentElement, nextElement).css(dir,
                                from + "%")
                            resolve(true)
                        },50,resolve)
                    }).then((data) => {
                        
                    })
                    await reset


                    setTimeout(function () {
                        var bgPos = $(".img.container").css("background-position-y")
                        console.log(currentElement,nextElement)
                        $(e).find(".part").removeClass("return")
                        currentElement.style[dir] = to + "%"
                        nextElement.style[dir] = "0%"
                    }, 50)

                })
                this.current = p

            }

        }

        function scrolling(e) {
            var next
            var playScroll = false
            if (e.type = "keydown" && (e.keyCode == 40 || e.keyCode == 38)) {
                next = keyCode == 40 ? current + 1 : current - 1
                playScroll = true
            }
            if (e.timeStamp && e.timeStamp - start > 200) {
                next = e.wheelDelta < 0 ? current + 1 : current - 1
            }

            if (playScroll) {


                next = next < 1 ? 1 : next > document.querySelectorAll(".scroll-container")[0].children.length ?
                    document.querySelectorAll(".scroll-container")[0].children.length : next
                scrollTo(next)
            }

            start = e.timeStamp
        }

        function scrollTo(p) {

            var parts = []
            var scrollContainers = document.querySelectorAll(".scroll-container").forEach((e, i) => {


                let name = e.getAttribute("name")

                let currentElement = e.querySelector("#" + name + "-" + current)
                let nextElement = e.querySelector("#" + name + "-" + p)




                /*              nextElement.style.display=""
                                let offsetTop = Number(window.getComputedStyle(nextElement).top.replace("px", ""))
                                let offsetLeft = Number(window.getComputedStyle(nextElement).left.replace("px", "")) */
                /*                 e.querySelector("[id*="+name+"]:not("+"#" + name + "-" + p+")").style.display="none" */
                if (p < current) {
                    /* e.appendChild(e.children[0]) */
                    /*                     e.insertBefore(nextElement, currentElement)
                                        e.querySelector("#" + name + "-" + current).style.transform = "translateY(0%)"
                                        e.querySelector("#" + name + "-" + current).getAnimations().forEach(e => {

                                            if (e.animationName == "scrollDown") {
                                                console.log(e)
                                                e.play()
                                            }
                                        })
                                        e.querySelector("#" + name + "-" + p).style.transform = "translateY(-100%)"
                                        e.querySelector("#" + name + "-" + p).getAnimations().forEach(e => {
                                            if (e.animationName == "scrollUp") {
                                                e.play()
                                            }
                                        }) */
                    currentElement.style.top = "100%"
                    nextElement.style.top = "0%"



                } else {
                    currentElement.style.top = "-100%"
                    nextElement.style.top = "0%"
                    e.insertBefore(nextElement, currentElement.nextElementSibling)
                    e.querySelector("#" + name + "-" + current).style.transform = "translateY(-100%)"

                    e.querySelector("#" + name + "-" + current).getAnimations().forEach(e => {

                        if (e.animationName == "scrollUp") {
                            console.log(e)
                            e.play()
                        }
                    })
                    e.querySelector("#" + name + "-" + p).style.transform = "translateY(100%)"
                    e.querySelector("#" + name + "-" + p).getAnimations().forEach(e => {
                        if (e.animationName == "scrollDown") {
                            e.play()
                        }
                    })



                }
                console.log(current, p)



                /*                 e.scrollTo({
                                    top: e.querySelector("#" + name + "-" + p).offsetTop,
                                    left: e.querySelector("#" + name + "-" + p).offsetLeft,
                                    behavior: "smooth"
                                }) */

            })
            current = p

        }

        var scrolling = new scrollHandler(".scroll-container")
    </script>
</body>

</html>